## è·å–è–ªæ°´æ’åç¬¬äºŒå¤šçš„å‘˜å·¥ç¼–å·emp_noã€è–ªæ°´salaryã€last_nameä»¥åŠfirst_name
## å‘˜å·¥è¡¨employeesç®€å†µå¦‚ä¸‹:
|emp_no|first_name|last_name |
|------|----------|----------|

è–ªæ°´è¡¨salariesç®€å†µå¦‚ä¸‹:
|emp_no|salary|
|------|------|

##æ–¹æ³•ä¸€ï¼ŒåµŒå¥—æŸ¥è¯¢ï¼Œç¬¬ä¸€æ¬¡å…ˆæŸ¥è–ªæ°´è¡¨æœ€å¤§çš„è–ªæ°´ï¼Œç¬¬äºŒæ¬¡æŸ¥é™¤äº†ç¬¬ä¸€æ¬¡ç»“æœçš„æœ€å¤§çš„è–ªæ°´ï¼ˆç¬¬äºŒåçš„è–ªæ°´ï¼‰ï¼Œç¬¬ä¸‰æ¬¡ç›´æ¥ä½¿ç”¨ç¬¬äºŒæ¬¡çš„ç»“æœå³å¯
select
--ç¬¬ä¸‰æ¬¡
    e.emp_no,
    s.salary,
    last_name,
    first_name
from
    employees e
    left join salaries s on e.emp_no = s.emp_no
WHERE
    s.salary = (
    --ç¬¬äºŒæ¬¡
        select
            max(s1.salary)
        from
            salaries s1
        WHERE
            s1.salary < (
            --ç¬¬ä¸€æ¬¡
                select
                    max(salary)
                from
                    salaries
            )
    )
##æ–¹æ³•äºŒï¼Œä¸ä½¿ç”¨åµŒå¥—æŸ¥è¯¢ï¼Œè€Œæ˜¯å…ˆè‡ªè¿æ¥ï¼Œæ¡ä»¶æ˜¯ å·¦è¡¨è–ªæ°´ <= å³è¡¨è–ªæ°´ï¼Œç„¶åä»¥å·¦è¡¨çš„è–ªæ°´è¿›è¡Œåˆ†ç»„ï¼Œå†å¯¹å³è¡¨çš„å€¼å»é‡ä¹‹åè®¡ç®—æ¯ä¸€ç»„çš„åˆ—æ•°ï¼Œé€‰åˆ—æ•°=2çš„
##å°±æ˜¯ç¬¬äºŒå¤§çš„ï¼Œå› ä¸ºè–ªèµ„æœ€é«˜çš„é‚£ç»„åªæœ‰å®ƒè‡ªå·±æœ¬èº«ï¼Œè–ªèµ„ç¬¬äºŒé«˜é‚£ç»„æœ‰å·¥èµ„æœ€é«˜çš„é‚£ç»„å’Œå®ƒè‡ªå·±æœ¬èº«ã€‚
##ä¸¾ä¸ªä¾‹å­ï¼š

salary
1000
2000 
3000
    ğŸ‘‡
s1_salary|	s2_salary
   1000  |  1000
   1000  |  2000
   1000  |  3000
-----------------
   2000  |  2000
   2000  |  3000
-----------------
   3000  |  3000
åˆ†ç»„ä¹‹åï¼Œå¯ä»¥çœ‹å‡ºå·¥èµ„è¶Šä½ï¼Œå¯¹åº”çš„å³è¡¨åˆ—çš„å…ƒç´ è¶Šå¤š
s1_salary|	s2_salary
   1000	 | (1000, 2000, 3000)
----------------------------
   2000	 | (2000, 3000)
----------------------------
   3000	 | (3000)
å»é‡å¹¶è®¡ç®—åˆ—æ•°
1000 = 3
2000 = 2
3000 = 1

select
    e.emp_no,
    s.salary,
    last_name,
    first_name
from
    employees e
    left join salaries s on e.emp_no = s.emp_no
WHERE
    s.salary = (
        select
            s1.salary
        from
            salaries s1
            join salaries s2 on s1.salary <= s2.salary
        group by
            s1.salary
        having
            count(DISTINCT s2.salary) = 2
    )

